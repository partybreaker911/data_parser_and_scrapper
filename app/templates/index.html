<!-- index.html -->

<!DOCTYPE html>
<html>
<head>
    <title>Product Prices</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            // Обработка изменений в выборе категории
            $('#category').change(function() {
                var category_id = $(this).val();
                window.location.href = '/?category_id=' + category_id;
            });

            // Обработка изменений в выборе сети продуктов
            $('#place').change(function() {
                var category_id = $('#category').val();
                var place_id = $(this).val();
                var url = '/?category_id=' + category_id;
                if (place_id !== '') {
                    url += '&place_id=' + place_id;
                }
                window.location.href = url;
            });
        });
    </script>
</head>
<body>
    <h1>Product Prices</h1>

    <form>
        <label for="category">Select a category:</label>
        <select name="category_id" id="category">
            <option value="">All</option>
            {% for category in categories %}
                <option value="{{ category['id'] }}" {% if category['id'] == selected_category_id %}selected{% endif %}>{{ category['name'] }}</option>
            {% endfor %}
        </select>

        <label for="place">Select a place:</label>
        <select name="place_id" id="place">
            <option value="">All</option>
            {% for place in places %}
                <option value="{{ place['id'] }}" {% if place['id'] == selected_place_id %}selected{% endif %}>{{ place['name'] }}</option>
            {% endfor %}
        </select>
    </form>

    <table>
        <thead>
            <tr>
                <th>Product</th>
                <th>Category</th>
                <th>Price</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            {% for row in rows %}
                <tr>
                    <td>{{ row['product_name'] }}</td>
                    <td>{{ row['category_name'] }}</td>
                    <td>{{ row['price'] }}</td>
                    <td>{{ row['date'] }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>